<!DOCTYPE html>
<html lang="en">
  <link href="../css/bootstrap.css" rel="stylesheet">
  <link href="css/bootstrap.css" rel="stylesheet">  
  <head>
	  <title>save face :: social network profile aggregator</title>
  </head>
  <body>
	<div class="container-fluid">
	  <div class="row">
		<div class="span4"><h3>nodebox fb archiver</h3></div>
		<div class="span8">
		  <div id="me" class="btn" disabled='true'><i class="icon-user"></i> my profile </div>
		  <div id="statuses" class="btn" disabled='true'><i class="icon-comment"></i> my statuses</div>
		  <div id="inbox" class="btn" disabled='true'><i class="icon-pencil"></i> my messages</div>
		  <div id="feed" class="btn" disabled='true'><i class="icon-listt"></i> news feed</div>		  
		  <div id="friends" class="btn" disabled='true'><i class="icon-user"></i> friends</div>
		</div>
	  </div>
	</div>
	<div id="fb-root"></div>
	<script src="../lib/jquery-1.7.2.min.js" type="text/javascript"></script>
	<script src="../lib/underscore-min.js" type="text/javascript"></script>
	<script src="../lib/backbone.js" type="text/javascript"></script>
	<script src="../lib/require.js"></script>
	<script>
	  var host = document.location.host;
	  var channelURL = '//'+host+'/channel.html';
	  console.log('checking for channel file at ', channelURL);
	  // Additional JS functions here
	  window.fbAsyncInit = function() {
         FB.init({
           appId      : '296646860441717', // App ID
           channelUrl : channelURL, // Channel File
           status     : true, // check login status
           cookie     : true, // enable cookies to allow the server to access the session
           xfbml      : true  // parse XFBML
         });
         // Additional init code here
       var path = document.location.pathname;
       var basepath = path.slice(0,path.lastIndexOf('/')); // chop off 2 /'s
       basepath = basepath.slice(0,Math.max(0,basepath.lastIndexOf('/'))) || '/';
       console.log('setting baseurl to ', document.location.pathname, '-', basepath);
       require.config({ baseUrl:  basepath });
       require(['plugins/fb', 'js/models'], function(nodebox, fb, models) {
	      $.getScript('http://'+host+':8211/js/objectstore.js', function() {
	  	      var store = new ObjectStore.Store();
              store.server_url = "http://"+host+":8211/webbox/";
              var graph = store.get("http://example.com/graph");
	          graph.fetch().success(function() {
	              console.log('ok to run fb code!');

                  console.debug("graph", graph);

                  var boo = graph.create({"@id": "123982388", "eats": "pizza"});
//                  var boo = new ObjectStore.Obj({"@id":123982389});
 //                 graph.get("objects").add(boo);
                  boo.save();

                  
	          }).error(function(err)  {
	              console.log('error in fetch ', err);
	          });
     	  });
	    });
	  };
	  // Load the SDK Asynchronously
	  (function(d){
      var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/en_US/all.js";
      ref.parentNode.insertBefore(js, ref);
	  }(document));
	</script>	
  </body>

  <script src="../lib/codemirror2/codemirror.js"></script>
  <link href="../lib/codemirror2/codemirror.css" rel="stylesheet">  
  <script src="../lib/codemirror2/mode/javascript/javascript.js"></script>  
  <script type="text/javascript" src="../lib/rdfquery/jquery.uri.js"></script>
  <script type="text/javascript" src="../lib/rdfquery/jquery.xmlns.js"></script>
  <script type="text/javascript" src="../lib/rdfquery/jquery.curie.js"></script>      
  <script type="text/javascript" src="../lib/rdfquery/jquery.datatype.js"></script>
  <script type="text/javascript" src="../lib/rdfquery/jquery.rdf.js"></script>
  <script type="text/javascript" src="../lib/rdfquery/jquery.rdfa.js"></script>
  <script type="text/javascript" src="../lib/rdfquery/jquery.rdf.xml.js"></script>
  <script type="text/javascript" src="../lib/rdfquery/jquery.rdf.turtle.js"></script>  
  <script type="text/javascript" src="../lib/rdfquery/jquery.rdf.json.js"></script>
</html>

